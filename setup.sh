#!/bin/bash
# ==============================================
#  Llama 3.1 8B Instruct â€” Setup Script
#  ì‹¤í–‰: bash setup.sh
# ==============================================

set -e

echo "======================================"
echo "  ğŸ¦™ Llama 3.1 8B Instruct Setup"
echo "======================================"

# ----------------------------------------------
# 1. Ollama ì„¤ì¹˜
# ----------------------------------------------
echo ""
echo "[1/3] Ollama ì„¤ì¹˜ ì¤‘..."
curl -fsSL https://ollama.ai/install.sh | sh
echo "âœ… Ollama ì„¤ì¹˜ ì™„ë£Œ"

# ----------------------------------------------
# 2. Open WebUI ì„¤ì¹˜
# ----------------------------------------------
echo ""
echo "[2/3] Open WebUI ì„¤ì¹˜ ì¤‘..."
pip install open-webui --quiet
echo "âœ… Open WebUI ì„¤ì¹˜ ì™„ë£Œ"

# ----------------------------------------------
# 3. ëª¨ë¸ ë‹¤ìš´ë¡œë“œ
# ----------------------------------------------
echo ""
echo "[3/3] ëª¨ë¸ ë‹¤ìš´ë¡œë“œ ì¤‘... (ì‹œê°„ì´ ì†Œìš”ë©ë‹ˆë‹¤)"

# Ollama ì„œë¹„ìŠ¤ ë°±ê·¸ë¼ìš´ë“œ ì‹œì‘
ollama serve &
OLLAMA_PID=$!
sleep 5

ollama pull llama3.1:8b

echo "âœ… ëª¨ë¸ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ"

# Ollama ì¢…ë£Œ (start.shì—ì„œ ë‹¤ì‹œ ì‹œì‘)
kill $OLLAMA_PID 2>/dev/null || true

# ----------------------------------------------
# ì™„ë£Œ
# ----------------------------------------------
echo ""
echo "======================================"
echo "  âœ… Setup ì™„ë£Œ!"
echo "  ì´ì œ ì•„ë˜ ëª…ë ¹ì–´ë¡œ ì„œë¹„ìŠ¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”:"
echo ""
echo "  bash start.sh"
echo "======================================"